%% UU - Kapitein Lab
% Analyze in vitro single molecule motility assays
% MKI and CC 2019-11-05

%%
% TO DO:
% MSD analysis for vel, diff coeff
% sliding MSD analysis


%% This code reads in the files generated by post_particle_tracking_1 for one condition.
% To use this file you will need the following files:
% .mat file output by post_particle_tracking_1
%
% Ensure that tMSD_2D.m and MSD_2D.m are in the same folder as this code.
%
%% Options (make 0 to NOT perform related action, 1 to perform)
zplot = 0;
zsave = 0;

%% Parameters
% From imaging:
pixel_size = 64.0; %pixel size of camera [nm]
exp_time = 0.1; %exposure time [s]
num_frames = 600; %number of frames in movie [frames]
num_pix_x = 512;
num_pix_y = 512;

% For analysis
l_window = 7; %number of frames to average for sliding MSD analysis
msd_thresh = 1.1; %alpha-value above which is processive, below which is paused
msd_step = 0.3; %minimum threshold for findchangepts function; minimum improvement in residual error; changepoints currently based on mean values, but can use rms, std, mean and slope
l_min = 3; %minimum distance between two changepoints - smallest duration of pause/run

% For plotting:
rl_binwidth = 100; %bin width for run length histograms

%% Movies to analyze
motor = 'kif1a';
mt_type = '1cycle_cpp';
date = ['2019-10-30']; %, '2019-11-12'];

%% Load data
dirname =strcat('C:\Users\6182658\OneDrive - Universiteit Utrecht\in_vitro_data','\',date,'\',motor,'\',mt_type,'\'); %windows
% dirname =strcat('/Users/malinaiwanski/OneDrive - Universiteit Utrecht/in_vitro_data','/',date,'/',motor,'/',mt_type,'/'); %mac

% Read in

%% Initialize figures
if zplot ~= 0
    
end
%% Initialize variables


%% Analyze


%% Save data
if zsave ~= 0
    
end